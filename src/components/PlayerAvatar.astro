---
interface Props {
  name: string;
  pgaId?: number | null;
  size?: number;
  class?: string;
}

const { name, pgaId, size = 32, class: className } = Astro.props;

const initials = name
  .split(" ")
  .map((part) => part.charAt(0))
  .slice(0, 2)
  .join("")
  .toUpperCase();

// Use local image path if pgaId is available
const localImagePath = pgaId ? `/images/players/${pgaId}.webp` : null;
---

{
  localImagePath ? (
    <img
      src={localImagePath}
      alt={name}
      width={size}
      height={size}
      loading="lazy"
      onerror="this.style.display='none'; this.nextElementSibling.style.display='inline-flex';"
      class:list={["player-avatar", "player-avatar-image", className]}
    />
  ) : null
}
<span
  class:list={["player-avatar", "player-avatar-initials", className]}
  style={`width: ${size}px; height: ${size}px; font-size: ${size * 0.4}px;${localImagePath ? ' display: none;' : ''}`}
>
  {initials}
</span>

<style>
  .player-avatar {
    border-radius: 999px;
    flex-shrink: 0;
  }

  .player-avatar-image {
    object-fit: cover;
  }

  .player-avatar-initials {
    background: #eef2ff;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    color: #4f46e5;
  }
</style>
